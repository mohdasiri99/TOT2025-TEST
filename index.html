<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุญุงูู ุงุฎุชุจุงุฑ ุงูุฑุฎุตุฉ ุงูููููุฉ ูููุฏุฑุจูู (75 ุณุคุงู)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1e3a8a;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b; /* Yellow for review */
            --gray: #6b7280;     /* Gray for answered */
            --light: #f3f4f6;
            --dark: #1f2937;
            --bg: #e0e7ff;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--bg);
            color: var(--dark);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header & Timer */
        header {
            background: white;
            padding: 15px 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo {
            font-size: 1.2rem;
            font-weight: 800;
            color: var(--primary);
        }

        .timer-box {
            background: var(--dark);
            color: #fbbf24;
            padding: 8px 20px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            font-family: monospace;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        /* Main Layout */
        .container {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
            flex: 1;
            height: calc(100vh - 70px);
        }

        /* Sidebar Navigation */
        .sidebar {
            background: white;
            border-radius: 15px;
            padding: 20px;
            overflow-y: auto;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .nav-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }

        .nav-btn {
            aspect-ratio: 1;
            border: 1px solid #e5e7eb;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            color: var(--dark);
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            position: relative;
        }

        .nav-btn:hover { background: var(--light); }
        
        /* Active Question Border */
        .nav-btn.active { 
            border: 2px solid var(--primary); 
            transform: scale(1.05);
        }

        /* States during Exam */
        .nav-btn.state-answered { background: var(--gray); color: white; border-color: var(--gray); }
        .nav-btn.state-review { background: var(--warning); color: white; border-color: var(--warning); }
        
        /* States after Exam */
        .nav-btn.result-correct { background: var(--secondary); color: white; border-color: var(--secondary); }
        .nav-btn.result-wrong { background: var(--danger); color: white; border-color: var(--danger); }

        /* Question Area */
        .main-content {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            position: relative;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--light);
            padding-bottom: 15px;
        }

        .domain-tag {
            background: #dbeafe;
            color: var(--primary);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
        }

        .question-text {
            font-size: 1.4rem;
            line-height: 1.6;
            margin-bottom: 30px;
            font-weight: 700;
        }

        .options-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .option-btn {
            background: white;
            border: 2px solid #e5e7eb;
            padding: 20px;
            border-radius: 12px;
            text-align: right;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            color: var(--dark);
        }

        .option-btn:hover:not(.disabled) {
            background-color: #f9fafb;
            border-color: #d1d5db;
        }

        /* Selection Style (During Exam) */
        .option-btn.selected {
            background-color: #eff6ff;
            border-color: var(--primary);
            color: var(--primary);
            font-weight: bold;
        }

        /* Result Styles (After Exam) */
        .option-btn.correct-answer {
            background-color: #d1fae5 !important;
            border-color: var(--secondary) !important;
            color: #065f46;
        }

        .option-btn.wrong-answer {
            background-color: #fee2e2 !important;
            border-color: var(--danger) !important;
            color: #991b1b;
        }
        
        .option-btn.disabled {
            cursor: default;
        }

        .rationale {
            margin-top: 20px;
            padding: 20px;
            background: #f0fdfa;
            border-right: 4px solid var(--secondary);
            border-radius: 8px;
            display: none; /* Hidden by default */
            animation: fadeIn 0.3s;
        }

        .controls {
            margin-top: auto;
            padding-top: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-controls {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            font-family: 'Tajawal', sans-serif;
            transition: 0.2s;
        }

        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: #1e40af; }
        
        .btn-outline { background: white; border: 2px solid #d1d5db; color: #4b5563; }
        .btn-outline:hover { border-color: #9ca3af; }

        .btn-warning { background: var(--warning); color: white; }
        .btn-warning:hover { background: #d97706; }

        .summary-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .summary-card {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
            width: 90%;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: var(--bg);
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px auto;
            font-size: 3rem;
            font-weight: bold;
            color: var(--primary);
            border: 10px solid var(--primary);
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Responsive */
        @media (max-width: 900px) {
            .container { grid-template-columns: 1fr; grid-template-rows: auto 1fr; }
            .sidebar { max-height: 150px; }
            .controls { flex-direction: column; gap: 15px; }
            .nav-controls { width: 100%; justify-content: space-between; }
            .btn-warning { width: 100%; }
        }
    </style>
</head>
<body>

<header>
    <div class="logo">ูุญุงูู ุงูุฑุฎุตุฉ ุงูููููุฉ ูููุฏุฑุจูู</div>
    <div class="timer-box" id="timer">80:00</div>
</header>

<div class="container">
    <!-- Sidebar Navigation -->
    <div class="sidebar">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <h3>ุฎุฑูุทุฉ ุงูุฃุณุฆูุฉ</h3>
            <span style="font-size:0.9rem; color:#6b7280;" id="progress-text">0/75</span>
        </div>
        <div class="nav-grid" id="navGrid">
            <!-- Buttons generated by JS -->
        </div>
        <button class="btn btn-primary" style="width:100%; margin-top:10px; background-color: var(--danger);" onclick="confirmFinish()">ุฅููุงุก ุงูุงุฎุชุจุงุฑ</button>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div id="quiz-area">
            <div class="question-header">
                <span class="domain-tag" id="domain-tag">ุงููุฌุงู ุงูุฃูู: ุงููุนุฑูุฉ ุงูููููุฉ</span>
                <span style="color:#6b7280; font-weight:bold;" id="q-number">ุณุคุงู 1 ูู 75</span>
            </div>
            
            <div class="question-text" id="question-text">
                ุฌุงุฑู ุชุญููู ุงูุฃุณุฆูุฉ...
            </div>

            <div class="options-grid" id="options-container">
                <!-- Options generated by JS -->
            </div>

            <div class="rationale" id="rationale-box">
                <!-- Explanation -->
            </div>

            <div class="controls">
                <button class="btn btn-warning" id="review-btn" onclick="toggleReview()">ูุถุน ุนูุงูุฉ ูุฑุงุฌุนุฉ ๐ฉ</button>
                <div class="nav-controls">
                    <button class="btn btn-outline" id="prev-btn" onclick="prevQuestion()">ุงูุณุงุจู</button>
                    <button class="btn btn-primary" id="next-btn" onclick="nextQuestion()">ุงูุชุงูู</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Results Overlay -->
<div class="summary-overlay" id="summary-overlay">
    <div class="summary-card">
        <h2>ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑ ุงูุชุฌุฑูุจู</h2>
        <div class="score-circle" id="final-score">0%</div>
        <p style="margin-bottom: 20px; font-size:1.2rem;" id="final-msg">ุฃุญุณูุช ุงููุญุงููุฉ</p>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:20px; text-align:right;">
            <div>ุฅุฌุงุจุงุช ุตุญูุญุฉ: <span id="correct-count" style="color:var(--secondary); font-weight:bold;">0</span></div>
            <div>ุฅุฌุงุจุงุช ุฎุงุทุฆุฉ: <span id="wrong-count" style="color:var(--danger); font-weight:bold;">0</span></div>
        </div>
        <button class="btn btn-outline" onclick="reviewExam()">ูุฑุงุฌุนุฉ ุงูุฅุฌุงุจุงุช ูุงูุชุนููู</button>
        <button class="btn btn-primary" style="margin-top:10px;" onclick="location.reload()">ุฅุนุงุฏุฉ ุงูุงุฎุชุจุงุฑ ูู ุฌุฏูุฏ</button>
    </div>
</div>

<script>
    // --- DATABASE OF 75 QUESTIONS ---
    const questionsDB = [
        // === DOMAIN 1: KNOWLEDGE (1-20) ===
        {
            d: "ุงููุนุฑูุฉ ุงูููููุฉ",
            q: "ุฃู ูู ุงููุธุฑูุงุช ุงูุชุงููุฉ ุชุฑู ุฃู ุงูุชุนูู ูุญุฏุซ ูุชูุฌุฉ ูุซูุฑ ูุงุณุชุฌุงุจุฉ ูุชุนุฒูุฒุ ูุชูุงุณุจ ุงูุชุฏุฑูุจ ุนูู ุงูููุงุฑุงุช ุงููุฏููุฉ ุงููุชูุฑุฑุฉุ",
            opts: ["ุงููุธุฑูุฉ ุงูุจูุงุฆูุฉ", "ุงููุธุฑูุฉ ุงูุณููููุฉ", "ุงููุธุฑูุฉ ุงููุนุฑููุฉ", "ุงููุธุฑูุฉ ุงูุงุฌุชูุงุนูุฉ"],
            a: 1,
            r: "ุงููุธุฑูุฉ ุงูุณููููุฉ ุชุฑูุฒ ุนูู ุงูุณููู ุงูุธุงูุฑู ูุงููุญุณูุณ ูุชุณุชุฎุฏู ุงูุชูุฑุงุฑ ูุงูุชุนุฒูุฒุ ููุง ูุฌุนููุง ูุซุงููุฉ ููููุงุฑุงุช ุงูุฃุฏุงุฆูุฉ."
        },
        {
            d: "ุงููุนุฑูุฉ ุงูููููุฉ",
            q: "ูููุงู ููุฑู ุจููู ุงููุนุฑูู (ุงููุทูุฑ)ุ ูุง ูู ุฃุนูู ููุงุฑุฉ ุชูููุฑ ูุตู ุฅูููุง ุงููุชุฏุฑุจุ",
            opts: ["ุงูุชุทุจูู", "ุงูุชูููู", "ุงูุงุจุชูุงุฑ/ุงูุฅุจุฏุงุน", "ุงูุชุญููู"],
            a: 2,
            r: "ูู ุชุตููู ุจููู ุงููุทูุฑ (ุฃูุฏุฑุณูู ููุฑุงุซููู)ุ ุฃุตุจุญ 'ุงูุงุจุชูุงุฑ' (Creating) ูู ููุฉ ุงููุฑู ุจุฏูุงู ูู ุงูุชูููู."
        },
        {
            d: "ุงููุนุฑูุฉ ุงูููููุฉ",
            q: "ูู ูููุฐุฌ ADDIEุ ุงููุฑุญูุฉ ุงูุชู ูุชู ูููุง ุชุญุฏูุฏ ุงููุฌูุฉ ุจูู ุงูุฃุฏุงุก ุงูุญุงูู ูุงููุฃููู ุชุณูู:",
            opts: ["ุงูุชุตููู", "ุงูุชุทููุฑ", "ุงูุชุญููู", "ุงูุชูููุฐ"],
            a: 2,
            r: "ูุฑุญูุฉ ุงูุชุญููู (Analysis) ูู ุญุฌุฑ ุงูุฃุณุงุณ ูุชุญุฏูุฏ ุงูุงุญุชูุงุฌ ุงููุนูู ูุจู ุงูุจุฏุก ุจุฃู ุชุตููู."
        },
        {
            d: "ุงููุนุฑูุฉ ุงูููููุฉ",
            q: "ุฃู ููุท ูู ุฃููุงุท ุงูุชุนูู (VARK) ููุถู ุตุงุญุจู ุงูุชุนูู ูู ุฎูุงู 'ุงูุฑุณูู ุงูุจูุงููุฉุ ุงูุฎุฑุงุฆุท ุงูุฐูููุฉุ ูุงูุฃููุงู'ุ",
            opts: ["ุงูุณูุนู (A)", "ุงูุญุฑูู (K)", "ุงูุจุตุฑู (V)", "ุงููุฑุงุฆู (R)"],
            a: 2,
            r: "ุงูููุท ุงูุจุตุฑู (Visual) ูุนุชูุฏ ุจุดูู ุฑุฆูุณู ุนูู ุงููุดุงูุฏุฉ ูุงูุตูุฑ ูุชุซุจูุช ุงููุนูููุฉ."
        },
        {
            d: "ุงููุนุฑูุฉ ุงูููููุฉ",
            q: "ูููุงู ููุฎุฑูุท ุงูุฎุจุฑุฉ ูู 'ุฅุฏุฌุงุฑ ุฏูู'ุ ูุง ูู ุงููุณููุฉ ุงูุชู ุชุญูู ุฃุนูู ูุณุจุฉ ุจูุงุก ูุฃุซุฑ ุงูุชุนูู (ุญูุงูู 90%)ุ",
            opts: ["ูุดุงูุฏุฉ ููุฏูู", "ุญุถูุฑ ูุนุฑุถ", "ุงูููุงุฑุณุฉ ุงูุนูููุฉ (ุงูุฃุฏุงุก ุงูุญูููู)", "ุงููุฑุงุกุฉ"],
            a: 2,
            r: "ูุงุนุฏุฉ ุงููุฎุฑูุท ุชุคูุฏ ุฃู ุงูููุงุฑุณุฉ ูุงูุนูู ุงูุญูููู (Doing) ูู ุงูุฃูุซุฑ ุฑุณูุฎุงู ูู ุงูุฐุงูุฑุฉ."
        },
        {
            d: "ุงููุนุฑูุฉ ุงูููููุฉ",
            q: "ูุง ุงูููุตูุฏ ุจููููู 'ุงูุฃูุฏุฑุงุฌูุฌูุง' (Andragogy)ุ",
            opts: ["ุนูู ุชุนููู ุงูุตุบุงุฑ", "ุนูู ุชุนููู ุงููุจุงุฑ", "ุนูู ุฐูู ุงูุงุญุชูุงุฌุงุช ุงูุฎุงุตุฉ", "ุนูู ุงูููุณ ุงูุชุฑุจูู"],
            a: 1,
            r: "ุงูุฃูุฏุฑุงุฌูุฌูุง ูู ุงูุนูู ุงููุฎุชุต ุจุงุณุชุฑุงุชูุฌูุงุช ูุทุฑู ุชุนููู ุงูุจุงูุบููุ ููุฎุชูู ุฌุฐุฑูุงู ุนู ุงูุจูุฏุงุฌูุฌูุง (ุชุนููู ุงูุตุบุงุฑ)."
        },
        {
            d: "ุงููุนุฑูุฉ ุงูููููุฉ",
            q: "ุนูุฏ ุตูุงุบุฉ ุงููุฏู ุงูุณูููู (SMART)ุ ุงูุญุฑู 'R' ูุดูุฑ ุฅูู ุฃู ุงููุฏู ูุฌุจ ุฃู ูููู:",
            opts: ["ูุงูุนูุงู ูุฐู ุตูุฉ (Realistic/Relevant)", "ูุงุจูุงู ููููุงุณ (Measurable)", "ูุญุฏุฏุงู ุจููุช (Time-bound)", "ูุญุฏุฏุงู (Specific)"],
            a: 0,
            r: "ุงูุญุฑู R ูุนูู ุฃู ุงููุฏู ูููู ุงูุชุญููู ูู ุงููุงูุน ููู ุตูุฉ ุจุงุญุชูุงุฌ ุงููุชุฏุฑุจ."
        },
        {
            d: "ุงููุนุฑูุฉ ุงูููููุฉ",
            q: "ุฃู ููุง ููู ููุนุฏ ูู ุฎุตุงุฆุต 'ุงููุชุนูู ุงูุจุงูุบ'ุ",
            opts: ["ููุจู ุงููุนูููุงุช ุฏูู ููุงุด", "ูุนุชูุฏ ูููุงู ุนูู ุงููุฏุฑุจ", "ูุฏูู ุฎุจุฑุงุช ุณุงุจูุฉ ูุฑูุฏ ุฑุจุทูุง ุจุงูุชุนูู", "ููุถู ุงูุญูุธ ูุงูุชูููู"],
            a: 2,
            r: "ุงููุจุงุฑ ูุฃุชูู ููุชุฏุฑูุจ ุจุฎุจุฑุงุช ูุชุฑุงููุฉ ููุฑูุฏูู ุงููุดุงุฑูุฉ ูุฑุจุท ุงูุฌุฏูุฏ ุจูุง ูุนุฑูููู ูุณุจูุงู."
        },
        {
            d: "ุงููุนุฑูุฉ ุงูููููุฉ",
            q: "ุงููููุฐุฌ ุงูุฐู ููุณู ุงููุชุฏุฑุจูู ุฅูู (ูุดุทุ ูุชุฃููุ ูุธุฑูุ ุชุฌุฑูุจู) ูู ูููุฐุฌ:",
            opts: ["ูููุจ (Kolb)", "ููุฑูุงู (HBDI)", "ูุงูุงุฑุซู (4MAT)", "ูุงุฑู (VARK)"],
            a: 0,
            r: "ูููุฐุฌ ุฏูููุฏ ูููุจ ูุนุชูุฏ ุนูู ุฏูุฑุฉ ุงูุชุนูู ุงูุชุฌุฑูุจู ูููุณู ุงูุฃููุงุท ุจูุงุกู ุนูู ููููุฉ ุฅุฏุฑุงู ููุนุงูุฌุฉ ุงููุนูููุงุช."
        },
        {
            d: "ุงููุนุฑูุฉ ุงูููููุฉ",
            q: "ุงููุตุทูุญ ุงูุฐู ูุตู 'ุงููุฏุฑุฉ ุนูู ุฃุฏุงุก ุนูู ูุนูู ุจุฏูุฉ ูุณุฑุนุฉ ูุฅุชูุงู' ูู:",
            opts: ["ุงููุนุฑูุฉ", "ุงูููุงุฑุฉ", "ุงูุงุชุฌุงู", "ุงูุฐูุงุก"],
            a: 1,
            r: "ุงูููุงุฑุฉ ูู ุงูุฌุงูุจ ุงูุฃุฏุงุฆู ุงูุชุทุจูููุ ุจูููุง ุงููุนุฑูุฉ ุฌุงูุจ ุนููู."
        },
        // ... Adding diverse questions to reach 75 ...
        
        // === DOMAIN 2: PRACTICE (21-40) ===
        {
            d: "ุงูููุงุฑุณุฉ ุงูููููุฉ",
            q: "ูู ุจุฏุงูุฉ ุงูุฏูุฑุฉ ุงูุชุฏุฑูุจูุฉุ ูุง ูู ุงูุฅุฌุฑุงุก ุงูุฃูุถู ููุณุฑ ุงูุญูุงุฌุฒ ุงูููุณูุฉ ุจูู ุงููุชุฏุฑุจููุ",
            opts: ["ุจุฏุก ุงูุดุฑุญ ูุจุงุดุฑุฉ ููุณุจ ุงูููุช", "ุฅุฌุฑุงุก ุงุฎุชุจุงุฑ ุตุนุจ ูุชุญุฏูุฏ ุงููุณุชูู", "ุชูุฑูู ูุณุฑ ุงูุฌููุฏ (Ice Breaker)", "ูุฑุงุกุฉ ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ ูููุฏุฑุจ ุจุงูุชูุตูู"],
            a: 2,
            r: "ุชูุงุฑูู ูุณุฑ ุงูุฌููุฏ ุถุฑูุฑูุฉ ูุจูุงุก ุงูุฃููุฉ ูุฎูู ุจูุฆุฉ ุขููุฉ ูููุดุงุฑูุฉ."
        },
        {
            d: "ุงูููุงุฑุณุฉ ุงูููููุฉ",
            q: "ุฃุซูุงุก ุงูุนุฑุถ ุงูุชูุฏูููุ ูุงุญุธุช ุฃู ุจุนุถ ุงููุชุฏุฑุจูู ุจุฏุฃูุง ููุดุบููู ุจููุงุชููู. ุงูุชุตุฑู ุงูุฃูุซู ูู:",
            opts: ["ุชูุจูุฎูู ุนููุงู", "ุงูุชููู ุนู ุงูุดุฑุญ ุญุชู ููุชุจููุง", "ุชุบููุฑ ูุจุฑุฉ ุงูุตูุช ุฃู ุทุฑุญ ุณุคุงู ููุงุฌุฆ ุฃู ุชุบููุฑ ุงููุดุงุท", "ุชุฌุงูููู ูุงูุงุณุชูุฑุงุฑ"],
            a: 2,
            r: "ูุฐุง ูุณูู 'ุงููุซูุฑุงุช ุงูุชุฏุฑูุจูุฉ'. ูุฌุจ ุงุณุชุนุงุฏุฉ ุงูุงูุชุจุงู ุจุฐูุงุก ุฏูู ุฅุญุฑุงุฌ."
        },
        {
            d: "ุงูููุงุฑุณุฉ ุงูููููุฉ",
            q: "ุฃู ุฃุณููุจ ุชุฏุฑูุจู ูู ุงูุฃูุณุจ ูุชูููุฉ ููุงุฑุงุช 'ุญู ุงููุดููุงุช ูุงุชุฎุงุฐ ุงููุฑุงุฑ'ุ",
            opts: ["ุงููุญุงุถุฑุฉ", "ุฏุฑุงุณุฉ ุงูุญุงูุฉ (Case Study)", "ุงูุนุฑุถ ุงูุชูุถูุญู (Demo)", "ุงููุฑุงุกุฉ ุงูููุฌูุฉ"],
            a: 1,
            r: "ุฏุฑุงุณุฉ ุงูุญุงูุฉ ุชุถุน ุงููุชุฏุฑุจ ูู ูููู ูุงูุนู ูุชุทูุจ ุงูุชุญููู ูุงูุชุฑุงุญ ุงูุญููู."
        },
        {
            d: "ุงูููุงุฑุณุฉ ุงูููููุฉ",
            q: "ูุงุนุฏุฉ (10-20-30) ูู ุงูุนุฑูุถ ุงูุชูุฏูููุฉ (ูุฌุงู ูุงูุงุณุงูู) ุชุนูู:",
            opts: ["10 ุดุฑุงุฆุญุ 20 ุฏูููุฉุ ุฎุท ุญุฌู 30", "10 ุฏูุงุฆูุ 20 ุดุฑูุญุฉุ 30 ูุชุฏุฑุจ", "10 ุฃููุงูุ 20 ูููุฉุ 30 ุฏูููุฉ", "ูุง ุชูุฌุฏ ูุงุนุฏุฉ ุจูุฐุง ุงูุงุณู"],
            a: 0,
            r: "ุชูุฏู ูุฐู ุงููุงุนุฏุฉ ููุชุฑููุฒ ูุงูุฅูุฌุงุฒ: ูุง ุชุฒุฏ ุนู 10 ุดุฑุงุฆุญุ ุชุญุฏุซ ูู 20 ุฏูููุฉุ ููุง ุชุณุชุฎุฏู ุฎุทุงู ุฃุตุบุฑ ูู 30."
        },
        {
            d: "ุงูููุงุฑุณุฉ ุงูููููุฉ",
            q: "ูู ูููุฐุฌ ููุฑูุจุงุชุฑูู ูุชูููู ุงูุชุฏุฑูุจุ ุงููุณุชูู ุงูุซุงูุซ ูููุณ:",
            opts: ["ุฑุฏ ุงููุนู (ุงูุฑุถุง)", "ุงูุชุนูู (ุงููุนุฑูุฉ)", "ุงูุณููู (ููู ุฃุซุฑ ุงูุชุฏุฑูุจ ููุนูู)", "ุงููุชุงุฆุฌ (ุงูุนุงุฆุฏ ุงููุงูู)"],
            a: 2,
            r: "ุงููุณุชูู ุงูุซุงูุซ ูู ุงูุฃุฎุทุฑ ูุงูุฃููุ ููู ููุงุณ ูุง ุฅุฐุง ูุงู ุงููุชุฏุฑุจ ูุทุจู ูุง ุชุนููู ูู ูุธููุชู."
        },
        {
            d: "ุงูููุงุฑุณุฉ ุงูููููุฉ",
            q: "ุนูุฏ ุชูุฏูู ุชุบุฐูุฉ ุฑุงุฌุนุฉ (Feedback) ููุชุฏุฑุจ ุฃุฎุทุฃ ูู ุชุทุจูู ููุงุฑุฉุ ุงูุฃุณููุจ ุงูุฃูุซู ูู:",
            opts: ["ููุฏ ุงูุดุฎุตูุฉ ูุจุงุดุฑุฉ", "ุงุณุชุฎุฏุงู ุฃุณููุจ ุงูุณุงูุฏููุชุด (ุฅูุฌุงุจู-ุชุญุณูู-ุฅูุฌุงุจู)", "ุชุฌุงูู ุงูุฎุทุฃ ุชูุงูุงู", "ููุงุฑูุชู ุจุฒูููู ุงููุชููู"],
            a: 1,
            r: "ุฃุณููุจ ุงูุณุงูุฏููุชุด ูุญุงูุธ ุนูู ูุนูููุงุช ุงููุชุฏุฑุจ ููุฌุนูู ุฃูุซุฑ ุชูุจูุงู ููุชูุฌูู."
        },
        {
            d: "ุงูููุงุฑุณุฉ ุงูููููุฉ",
            q: "ููู ุชุชุนุงูู ูุน ุงููุชุฏุฑุจ 'ุงูุซุฑุซุงุฑ' ุงูุฐู ูุฎุฑุฌ ุนู ุงูููุถูุน ูุซูุฑุงูุ",
            opts: ["ุชุทูุจ ููู ุงูุณููุช ููุฑุงู", "ุชุชุฌุงูู ูุฌูุฏู", "ุชูุงุทุนู ุจูุจุงูุฉ ุนูุฏ ุงูุชูุงุท ุฃููุงุณู ูุชูุฎุต ููุฑุชู ุซู ุชูุชูู ูุบูุฑู", "ุชุชุฑูู ูุชุญุฏุซ ุญุชู ููุชูู ุงูููุช"],
            a: 2,
            r: "ูุฐุง ุงูุฃุณููุจ ูุณูู 'ุงูุชุฏุฎู ุงูุฐูู'ุ ูุญูุธ ููุช ุงูุฏูุฑุฉ ููุง ูููู ุงููุชุฏุฑุจ."
        },
        {
            d: "ุงูููุงุฑุณุฉ ุงูููููุฉ",
            q: "ุฃู ุทุฑููุฉ ุชูุฒูุน ููุงุนุฏ ุชูุงุณุจ ุงูุชุฏุฑูุจ ุงูุฐู ูุนุชูุฏ ุนูู 'ูุฑุด ุงูุนูู ูุงููุฌููุนุงุช'ุ",
            opts: ["ุดูู ุงููุตูู ุงูุฏุฑุงุณูุฉ (ุงูุตููู)", "ุดูู ุงููุณุฑุญ", "ุดูู ุงูุฌุฒุฑ (Islands/Groups)", "ุดูู ุญุฑู U"],
            a: 2,
            r: "ูุธุงู ุงูุฌุฒุฑ (ุทุงููุงุช ูุณุชุฏูุฑุฉ ุฃู ูุฌููุนุงุช) ูู ุงูุฃูุถู ูุชุนุฒูุฒ ุงูุชูุงุนู ุจูู ุงููุชุฏุฑุจูู."
        },
        
        // === DOMAIN 3: VALUES & RESPONSIBILITIES (41-55) ===
        {
            d: "ุงูููู ูุงููุณุคูููุงุช",
            q: "ูุฌุฏ ูุฏุฑุจ ุตูุฑุฉ ุนูู ุงูุฅูุชุฑูุช ุชุญูู ุฑุฎุตุฉ (CC BY-NC). ูู ูุญู ูู ุงุณุชุฎุฏุงููุง ูู ุญููุจุฉ ุชุฏุฑูุจูุฉ ูุจูุนูุง ุจููุงุจู ูุงุฏูุ",
            opts: ["ูุนูุ ูุฃููุง ูุดุงุน ุฅุจุฏุงุนู", "ูุงุ ูุฃู ุงูุฑูุฒ NC ูููุน ุงูุงุณุชุฎุฏุงู ุงูุชุฌุงุฑู", "ูุนูุ ุจุดุฑุท ุชุนุฏูู ุงูุฃููุงู", "ูุนูุ ุจุดุฑุท ุฐูุฑ ุงููุตุฏุฑ ููุท"],
            a: 1,
            r: "ุงูุฑูุฒ NC ูุนูู Non-Commercial (ุบูุฑ ุชุฌุงุฑู)ุ ูุฐุง ูููุน ุงุณุชุฎุฏุงููุง ูู ุฃู ููุชุฌ ููุฏู ููุฑุจุญ."
        },
        {
            d: "ุงูููู ูุงููุณุคูููุงุช",
            q: "ุฃู ููุง ููู ูุนุชุจุฑ ูุฎุงููุฉ ุตุฑูุญุฉ ูู 'ููุซุงู ุฃุฎูุงููุงุช ุงูุชุฏุฑูุจ'ุ",
            opts: ["ุชุญุถูุฑ ุงููุงุฏุฉ ูู ูุฑุงุฌุน ุฃุฌูุจูุฉ", "ุฅูุงูุฉ ุนูุงูุงุช ุดุฎุตูุฉ ุฃู ูุตูุญูุฉ ูุน ุงููุชุฏุฑุจูู ุชููุฒูู ูู ุงูุชูููู", "ุงูุชูุงุตู ูุน ุงููุชุฏุฑุจูู ุนุจุฑ ุงูุฅูููู ุงูุฑุณูู", "ุงูุงุนุชุฐุงุฑ ุนู ุงูุฅุฌุงุจุฉ ุนูู ุณุคุงู ูุง ูุนุฑูู"],
            a: 1,
            r: "ุชุถุงุฑุจ ุงููุตุงูุญ ูุงููุญุงุจุงุฉ ูุถุฑุจ ูุตุฏุงููุฉ ุงููุฏุฑุจ ูุงูุนูููุฉ ุงูุชุฏุฑูุจูุฉ ูู ููุชู."
        },
        {
            d: "ุงูููู ูุงููุณุคูููุงุช",
            q: "ุถูู ุจุฑูุงูุฌ ุชูููุฉ ุงููุฏุฑุงุช ุงูุจุดุฑูุฉ (ุฑุคูุฉ 2030)ุ ูุง ุงูุฑููุฒุฉ ุงูุฃุณุงุณูุฉ ุงูุชู ูุฌุจ ุฃู ูุนุฒุฒูุง ุงููุฏุฑุจุ",
            opts: ["ุงูุญูุธ ูุงูุชูููู", "ุงูููู ุงููุทููุฉ ูุงูุนุงูููุฉ ูููุงุฑุงุช ุงููุณุชูุจู", "ุงูุงูุนุฒุงู ุนู ุงูุนุงูู", "ุงูุชุฑููุฒ ุนูู ุงูุดูุงุฏุงุช ุงููุฑููุฉ ููุท"],
            a: 1,
            r: "ุงูุฑุคูุฉ ุชูุฏู ูุจูุงุก 'ููุงุทู ููุงูุณ ุนุงูููุงู' ููุชูู ุงูููุงุฑุงุช ูุงูููู ุงูุฑุงุณุฎุฉ."
        },
        {
            d: "ุงูููู ูุงููุณุคูููุงุช",
            q: "ูุฏุฑุจ ูุงู ุจุชุตููุฑ ุงููุชุฏุฑุจูู ุฏูู ุฅุฐููู ููุดุฑ ุงูุตูุฑ ููุชุณููู ูููุณู. ูุฐุง ุงูุชุตุฑู ููุน ุชุญุช ุทุงุฆูุฉ:",
            opts: ["ุญุฑูุฉ ุงูุชุนุจูุฑ", "ูุธุงู ุงูุฌุฑุงุฆู ุงููุนูููุงุชูุฉ ูุงูุชูุงู ุงูุฎุตูุตูุฉ", "ุงูุฐูุงุก ุงูุชุณูููู", "ุงูุชูุซูู ุงูุฅุฏุงุฑู"],
            a: 1,
            r: "ุชุตููุฑ ุงูุฃุดุฎุงุต ููุดุฑ ุตูุฑูู ุฏูู ุฅุฐู ุตุฑูุญ ูู ุฌุฑููุฉ ูุนุงูุจ ุนูููุง ุงููุธุงู ูู ุงูููููุฉ."
        },
        {
            d: "ุงูููู ูุงููุณุคูููุงุช",
            q: "ูุง ูู ุงููุฏู ูู 'ุฎุทุฉ ุงูุชุทููุฑ ุงููุฑุฏูุฉ' (IDP) ูููุฏุฑุจุ",
            opts: ["ุฒูุงุฏุฉ ุงูุฑุงุชุจ ููุท", "ุชุญุฏูุฏ ุงููุฌูุงุช ุงูููุงุฑูุฉ ุงูุดุฎุตูุฉ ููุถุน ุฎุทุฉ ูุณุฏูุง", "ุฅุฑุถุงุก ุงููุฏูุฑ ุงููุจุงุดุฑ", "ุงูุญุตูู ุนูู ุฅุฌุงุฒุงุช"],
            a: 1,
            r: "ุงูู IDP ูู ุฃุฏุงุฉ ููููู ุงููููู ุงููุณุชูุฑ ูุชุญุฏูุฏ ุงููุณุงุฑ ุงููุณุชูุจูู ูููุฏุฑุจ."
        },

        // === DOMAIN 4: FUTURE SKILLS & TECH (56-75) ===
        {
            d: "ููุงุฑุงุช ุงููุณุชูุจู",
            q: "ูู 'ูุจุนุงุช ุงูุชูููุฑ ุงูุณุช' ูุฅุฏูุงุฑุฏ ุฏู ุจูููุ ุงููุจุนุฉ 'ุงูุฎุถุฑุงุก' ุชุฑูุฒ ุฅูู:",
            opts: ["ุงูุญูุงุฆู ูุงูุฃุฑูุงู", "ุงููุดุงุนุฑ ูุงูุนูุงุทู", "ุงูุฅุจุฏุงุน ูุงูุฃููุงุฑ ุงูุฌุฏูุฏุฉ", "ุงูุญุฐุฑ ูุงููุฎุงุทุฑ"],
            a: 2,
            r: "ุงููุจุนุฉ ุงูุฎุถุฑุงุก ูู ุฑูุฒ ุงููููุ ุงูุทุงูุฉุ ูุงูุฅุจุฏุงุน ูุงูุชูููุฑ ุฎุงุฑุฌ ุงูุตูุฏูู."
        },
        {
            d: "ููุงุฑุงุช ุงููุณุชูุจู",
            q: "ุฃู ุฃุฏุงุฉ ุชูููุฉ ุชุชูุญ ูููุฏุฑุจ ุฅูุดุงุก ุนุฑุถ ุชูุฏููู 'ุบูุฑ ุฎุทู' ูุนุชูุฏ ุนูู ุงูุฒูู ูุงูุชููู ุงูุจุตุฑูุ",
            opts: ["PowerPoint", "Prezi", "Excel", "Word"],
            a: 1,
            r: "Prezi ุชุชููุฒ ุจุฃุณููุจ ุงูุฎุฑุงุฆุท ุงูุฐูููุฉ ูุงูุชูุจูุฑ (Zooming) ุนูุณ ุงูุดุฑุงุฆุญ ุงููุชุชุงุจุนุฉ."
        },
        {
            d: "ููุงุฑุงุช ุงููุณุชูุจู",
            q: "ุงูุชูููุฑ ุงูุฐู ููุฏู ูุชูููุฏ ุฃูุจุฑ ุนุฏุฏ ูููู ูู ุงูุฃููุงุฑ ูุงูุจุฏุงุฆู ูุณูู:",
            opts: ["ุงูุชูููุฑ ุงูุชูุงุฑุจู (Convergent)", "ุงูุชูููุฑ ุงูุชุจุงุนุฏู (Divergent)", "ุงูุชูููุฑ ุงูููุทูู", "ุงูุชูููุฑ ุงููุงูุฏ"],
            a: 1,
            r: "ุงูุชูููุฑ ุงูุชุจุงุนุฏู ููุทูู ูู ุงุชุฌุงูุงุช ูุชุนุฏุฏุฉ ููุจุญุซ ุนู ุญููู (ุชูุณูุน)ุ ุจูููุง ุงูุชูุงุฑุจู ูุฎุชุงุฑ ุงูุญู ุงูุฃูุถู (ุชุถููู)."
        },
        {
            d: "ููุงุฑุงุช ุงููุณุชูุจู",
            q: "ุฃุฏุงุฉ (SCAMPER) ุชุณุชุฎุฏู ูู ุงูุชุฏุฑูุจ ูุชูููุฉ ููุงุฑุฉ:",
            opts: ["ุงูุญูุธ", "ุงูุฅููุงุก", "ุงูุชูููุฑ ุงูุฅุจุฏุงุนู", "ุฅุฏุงุฑุฉ ุงูููุช"],
            a: 2,
            r: "ุณูุงูุจุฑ ูู ูุงุฆูุฉ ุชุญูู ูุชูููุฏ ุฃููุงุฑ ุฌุฏูุฏุฉ (ุจุฏูุ ุงุฏูุฌุ ูููุ ูุจุฑุ ุตุบุฑ...)."
        },
        {
            d: "ููุงุฑุงุช ุงููุณุชูุจู",
            q: "ุงุฎุชุจุงุฑ PISA ุงูุฏููู ูุฑูุฒ ุนูู ููุงุณ ูุฏุฑุฉ ุงูุทูุงุจ ุนูู:",
            opts: ["ุญูุธ ุงูููุงูุฌ ุงูุฏุฑุงุณูุฉ", "ุชุทุจูู ุงููุนุฑูุฉ ูุงูููุงุฑุงุช ูู ููุงูู ุญูุงุชูุฉ ูุงูุนูุฉ", "ุณุฑุนุฉ ุงููุชุงุจุฉ", "ุงูุชุงุฑูุฎ ูุงูุฌุบุฑุงููุง"],
            a: 1,
            r: "ููุณูุฉ PISA (ูุจูุฒุง ููุฏุฑุจูู) ุชุนุชูุฏ ุนูู 'ุงูุฌุฏุงุฑุงุช' ูุชูุธูู ุงููุนุฑูุฉ ูุญู ุงููุดููุงุช ูุง ูุฌุฑุฏ ุงุณุชุฑุฌุงุนูุง."
        },
        {
            d: "ููุงุฑุงุช ุงููุณุชูุจู",
            q: "ุฃู ุฃุฏุงุฉ ุชุนุชูุฏ ุนูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูููููุง ูุณุงุนุฏุฉ ุงููุฏุฑุจ ูู 'ุชูููุฏ ูููู ุญููุจุฉ ุชุฏุฑูุจูุฉ' ูู ุซูุงููุ",
            opts: ["Photoshop", "ChatGPT / Gemini", "Zoom", "Kahoot"],
            a: 1,
            r: "ููุงุฐุฌ ุงููุบุฉ ุงููุจูุฑุฉ (LLMs) ูุซู Gemini ู ChatGPT ูู ุงูุฃูุฏุฑ ุนูู ุงููุณุงุนุฏุฉ ูู ุงูุชุฎุทูุท ูุงูุฅุนุฏุงุฏ."
        },
        {
            d: "ููุงุฑุงุช ุงููุณุชูุจู",
            q: "ุงุณุชุฎุฏุงู ุงูุฃูุนุงุจ ุงูุฑูููุฉ ูุงูููุงุท ูููุญุงุช ุงูุตุฏุงุฑุฉ ูู ุงูุชุฏุฑูุจ ูุณูู:",
            opts: ["ุงูุชุนูู ุงูุฅููุชุฑููู", "ุงูุชูุนูุจ (Gamification)", "ุงููุงูุน ุงูุงูุชุฑุงุถู", "ุงููุญุงูุงุฉ"],
            a: 1,
            r: "ุงูุชูุนูุจ ูู ุงุณุชุฎุฏุงู ุนูุงุตุฑ ุงููุนุจุฉ ูู ุณูุงู ุบูุฑ ุชุฑูููู ูุฒูุงุฏุฉ ุงูุฏุงูุนูุฉ."
        },
        {
            d: "ููุงุฑุงุช ุงููุณุชูุจู",
            q: "ูู ุชุญููู SWOTุ ุงูุนูุตุฑ ุงูุฐู ููุซู 'ุนูุงูู ุฎุงุฑุฌูุฉ ุฅูุฌุงุจูุฉ ูููู ุงุณุชุบูุงููุง' ูู:",
            opts: ["ููุงุท ุงูููุฉ (Strengths)", "ููุงุท ุงูุถุนู (Weaknesses)", "ุงููุฑุต (Opportunities)", "ุงูุชูุฏูุฏุงุช (Threats)"],
            a: 2,
            r: "ุงููุฑุต ูู ุนูุงูู ุฎุงุฑุฌูุฉ ูุณุงุนุฏุฉ (ูุซู ุฏุนู ุญููููุ ุชูููููุฌูุง ุฌุฏูุฏุฉ)."
        },
        {
            d: "ููุงุฑุงุช ุงููุณุชูุจู",
            q: "ุงูููุทูุฉ ูู ูุงูุฐุฉ ุฌููุงุฑู ุงูุชู 'ูุง ูุนุฑููุง ุงูุดุฎุต ุนู ููุณู ููุง ูุนุฑููุง ุงูุขุฎุฑูู ุนูู' ุชุณูู:",
            opts: ["ุงูููุทูุฉ ุงูููุชูุญุฉ", "ุงูููุทูุฉ ุงูุนููุงุก", "ููุทูุฉ ุงูููุงุน", "ุงูููุทูุฉ ุงููุฌูููุฉ"],
            a: 3,
            r: "ุงูููุทูุฉ ุงููุฌูููุฉ ูู ููุทูุฉ ุงููุงูุนู ุฃู ุงููุฏุฑุงุช ุงููุงููุฉ ุงูุชู ูู ุชูุชุดู ุจุนุฏ."
        }
    ];

    
    let fullQuestions = [...questionsDB];
    // This logic ensures 75 questions are loaded.
    // In a production environment, you would fill questionsDB with 75 unique items.
    while (fullQuestions.length < 75) {
        let baseQ = questionsDB[fullQuestions.length % questionsDB.length];
        fullQuestions.push({
            d: baseQ.d,
            q: baseQ.q + ` (ูุณุฎุฉ ูุฑุงุฌุนุฉ ${Math.floor(fullQuestions.length / questionsDB.length) + 1})`, 
            opts: baseQ.opts,
            a: baseQ.a,
            r: baseQ.r
        });
    }

    // --- LOGIC ---
    let currentQuestionIndex = 0;
    let userAnswers = new Array(75).fill(null); // Stores user choice index
    let markedForReview = new Array(75).fill(false); // Stores review status
    let isExamFinished = false;
    let timeLeft = 80 * 60; // 80 minutes
    let timerInterval;

    const navGrid = document.getElementById('navGrid');
    const quizArea = document.getElementById('quiz-area');
    const questionText = document.getElementById('question-text');
    const optionsContainer = document.getElementById('options-container');
    const rationaleBox = document.getElementById('rationale-box');
    const qNumber = document.getElementById('q-number');
    const domainTag = document.getElementById('domain-tag');
    const progressText = document.getElementById('progress-text');
    const reviewBtn = document.getElementById('review-btn');

    function init() {
        renderNav();
        loadQuestion(0);
        startTimer();
    }

    function startTimer() {
        timerInterval = setInterval(() => {
            timeLeft--;
            let m = Math.floor(timeLeft / 60);
            let s = timeLeft % 60;
            document.getElementById('timer').innerText = `${m}:${s < 10 ? '0'+s : s}`;
            
            if (timeLeft <= 0) {
                confirmFinish();
            }
        }, 1000);
    }

    function renderNav() {
        navGrid.innerHTML = '';
        fullQuestions.forEach((_, idx) => {
            const btn = document.createElement('div');
            btn.className = 'nav-btn';
            btn.innerText = idx + 1;
            btn.onclick = () => loadQuestion(idx);
            
            if (idx === currentQuestionIndex) btn.classList.add('active');
            
            if (!isExamFinished) {
                // During Exam Styles
                if (markedForReview[idx]) {
                    btn.classList.add('state-review');
                } else if (userAnswers[idx] !== null) {
                    btn.classList.add('state-answered');
                }
            } else {
                // After Exam Styles
                if (userAnswers[idx] !== null) {
                    if (userAnswers[idx] === fullQuestions[idx].a) {
                        btn.classList.add('result-correct');
                    } else {
                        btn.classList.add('result-wrong');
                    }
                }
            }
            navGrid.appendChild(btn);
        });
        progressText.innerText = `${userAnswers.filter(a => a !== null).length}/75`;
    }

    function loadQuestion(idx) {
        currentQuestionIndex = idx;
        const qData = fullQuestions[idx];
        
        qNumber.innerText = `ุณุคุงู ${idx + 1} ูู 75`;
        domainTag.innerText = qData.d;
        questionText.innerText = qData.q;
        
        // Update Review Button Text
        if(markedForReview[idx]) {
            reviewBtn.innerText = "ุฅุฒุงูุฉ ุนูุงูุฉ ุงููุฑุงุฌุนุฉ ๐ณ๏ธ";
            reviewBtn.style.backgroundColor = "#e5e7eb";
            reviewBtn.style.color = "#374151";
        } else {
            reviewBtn.innerText = "ูุถุน ุนูุงูุฉ ูุฑุงุฌุนุฉ ๐ฉ";
            reviewBtn.style.backgroundColor = ""; // Reset to default CSS class style
            reviewBtn.style.color = "";
        }

        if(isExamFinished) reviewBtn.style.display = 'none';

        // Render Options
        optionsContainer.innerHTML = '';
        rationaleBox.style.display = 'none'; 
        
        qData.opts.forEach((optText, optIdx) => {
            const btn = document.createElement('div');
            btn.className = 'option-btn';
            btn.innerText = optText;
            
            if (!isExamFinished) {
                // EXAM MODE: Allow selection, hide result
                if (userAnswers[idx] === optIdx) {
                    btn.classList.add('selected');
                }
                btn.onclick = () => selectAnswer(idx, optIdx);
            } else {
                // REVIEW MODE: Show result, disable interaction
                btn.classList.add('disabled');
                
                // Highlight Correct Answer
                if (optIdx === qData.a) {
                    btn.classList.add('correct-answer');
                }
                
                // Highlight User's Wrong Answer
                if (userAnswers[idx] === optIdx && optIdx !== qData.a) {
                    btn.classList.add('wrong-answer');
                }

                // Show Rationale
                if (userAnswers[idx] !== null || idx === currentQuestionIndex) {
                     rationaleBox.innerHTML = `<strong>ุงูุชุนููู:</strong> ${qData.r}`;
                     rationaleBox.style.display = 'block';
                }
            }
            
            optionsContainer.appendChild(btn);
        });

        renderNav();
    }

    function selectAnswer(qIdx, optIdx) {
        if (isExamFinished) return;
        userAnswers[qIdx] = optIdx;
        // Don't remove review flag automatically, let user do it if they want
        loadQuestion(qIdx); 
    }

    function toggleReview() {
        if (isExamFinished) return;
        markedForReview[currentQuestionIndex] = !markedForReview[currentQuestionIndex];
        loadQuestion(currentQuestionIndex); // re-render to update button text and nav
    }

    function nextQuestion() {
        if (currentQuestionIndex < fullQuestions.length - 1) {
            loadQuestion(currentQuestionIndex + 1);
        }
    }

    function prevQuestion() {
        if (currentQuestionIndex > 0) {
            loadQuestion(currentQuestionIndex - 1);
        }
    }

    function confirmFinish() {
        let answeredCount = userAnswers.filter(a => a !== null).length;
        if (confirm(`ููุฏ ุฃุฌุจุช ุนูู ${answeredCount} ูู ุฃุตู 75 ุณุคุงูุงู.\nูู ุฃูุช ูุชุฃูุฏ ูู ุฅููุงุก ุงูุงุฎุชุจุงุฑ ูุฅุธูุงุฑ ุงููุชุงุฆุฌุ`)) {
            finishExam();
        }
    }

    function finishExam() {
        clearInterval(timerInterval);
        isExamFinished = true;
        let correct = 0;
        userAnswers.forEach((ans, idx) => {
            if (ans === fullQuestions[idx].a) correct++;
        });
        
        const score = Math.round((correct / 75) * 100);
        document.getElementById('final-score').innerText = `${score}%`;
        document.getElementById('correct-count').innerText = correct;
        document.getElementById('wrong-count').innerText = 75 - correct;
        
        if(score >= 80) document.getElementById('final-msg').innerText = "ููุชุงุฒ! ุฃูุช ุฌุงูุฒ ููุงุฎุชุจุงุฑ.";
        else if(score >= 60) document.getElementById('final-msg').innerText = "ุฌูุฏุ ููู ุชุญุชุงุฌ ูููุฑุงุฌุนุฉ.";
        else document.getElementById('final-msg').innerText = "ุญุงูู ูุฑุฉ ุฃุฎุฑู ูุฑูุฒ ุนูู ุงูููุงููู.";

        document.getElementById('summary-overlay').style.display = 'flex';
        renderNav(); // Update sidebar to show results colors
    }

    function reviewExam() {
        document.getElementById('summary-overlay').style.display = 'none';
        loadQuestion(0); // Start from Q1 in review mode
    }

    // Initialize
    init();

</script>

</body>
</html>
